---
title: "DuckTinyCC"
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

# DuckTinyCC

DuckTinyCC is a DuckDB C extension that exposes a `tcc_*` SQL surface for
TinyCC-driven C scripting workflows.

Current status:

- `tcc_module(...)` is available as the main table function.
- session-oriented configuration modes are implemented (`config_get`,
  `config_set`, `config_reset`, `list`).
- compile/register execution modes are present and currently return explicit
  `E_NOT_IMPLEMENTED` diagnostics until TinyCC runtime wiring is completed.

## Build

```sh
make configure
make debug
```

## Test

```sh
make test_debug
```

## Usage from R

```{r setup, message=FALSE, warning=FALSE}
library(DBI)
library(duckdb)
```

```{r connect}
db <- duckdb(config = list(allow_unsigned_extensions = "true"))
con <- dbConnect(
  db
)
dbExecute(con, "LOAD 'build/debug/capi_quack.duckdb_extension'")
```

```{r config-get}
dbGetQuery(con, "SELECT ok, mode, code, detail FROM tcc_module(mode := 'config_get')")
```

```{r config-set}
dbGetQuery(
  con,
  "SELECT ok, mode, code, detail
   FROM tcc_module(mode := 'config_set', runtime_path := 'third_party/tinycc')"
)
```

```{r compile-stub}
dbGetQuery(con, "SELECT ok, mode, code FROM tcc_module(mode := 'compile')")
```

The output is intentionally tabular and diagnostic-oriented, so SQL users can
inspect configuration and execution status directly inside DuckDB queries.

```{r cleanup}
dbDisconnect(con, shutdown = TRUE)
```
